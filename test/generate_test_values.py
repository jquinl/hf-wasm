from scipy.linalg import lu,inv,qr,eigh
import numpy as np

f = np.vectorize(lambda x: x if abs(x)>1e-5 else 00.0)

import numpy as np
from typing import Union

def write(arr, n):
    p,l,u = lu(arr)
    lus = l+u - np.eye(arr.shape[0])
    ev,evec = eigh(arr,eigvals_only=False)
    np.savetxt("test_values/csv/{}lu.csv".format(n), f(lus), delimiter=",",fmt='%.6f')
    np.savetxt("test_values/csv/{}inv.csv".format(n), f(inv(arr)), delimiter=",",fmt='%.6f')
    np.savetxt("test_values/csv/{}evec.csv".format(n), f(evec), delimiter=",",fmt='%.6f')
    np.savetxt("test_values/csv/{}eval.csv".format(n), f(ev), delimiter=",",fmt='%.6f')

S1 =np.array([
    [0.9999999908897999, 8.485806523168149e-16, 4.8976976063215463e-11, -8.326316139686609e-11, -8.326316139686609e-11, -8.326316139686609e-11],
    [8.485806523168148e-16, 1.0000000165470366, 0.2367039416499711, 6.311319040196644e-16, 6.311319040196644e-16, 6.311319040196644e-16],
    [4.8976976063215463e-11, 0.23670394164997102, 1.0000000268753377, 0.0, 0.0, 0.0],
    [-8.32631613968661e-11, 6.311319040196645e-16, 0.0, 1.0000000195212955, 0.0, 0.0 ],
    [-8.32631613968661e-11, 6.311319040196645e-16, 0.0, 0.0, 1.0000000195212955, 0.0 ],
    [-8.32631613968661e-11, 6.311319040196645e-16, 0.0, 0.0, 0.0, 1.0000000195212957]],dtype =np.float32)

S2 =np.array([[ 1.000000, 0.000000, 0.000000 ,-0.000000, -0.000000, -0.000000, 0.000002, 0.000255 ,-0.000343 ,-0.000251, -0.000126 ],
    [0.000000, 1.000000, 0.236704, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 ,0.000000, 0.000000, 0.000000 ],
    [0.000000, 0.236704, 1.000000, -0.000000, -0.000000, -0.000000, 0.000000, 0.000033 ,0.000023, 0.000041, 0.000066 ],
    [-0.000000, 0.000000, -0.000000, 1.000000, 0.000000, 0.000000, -0.000000, -0.000023 ,-0.000006 ,-0.000028, -0.000046 ],
    [-0.000000, 0.000000, -0.000000, 0.000000, 1.000000, 0.000000, -0.000000, -0.000041, -0.000028 ,-0.000041, -0.000083 ],
    [-0.000000, 0.000000, -0.000000, 0.000000, 0.000000, 1.000000, -0.000000, -0.000066, -0.000046 ,-0.000083, -0.000123 ],
    [0.000002, 0.000000, 0.000000, -0.000000, -0.000000, -0.000000, 1.000000, 0.236704, 0.000000, 0.000000, 0.000000 ],
    [0.000255, 0.000000, 0.000033, -0.000023, -0.000041, -0.000066, 0.236704, 1.000000, 0.000001, 0.000000, 0.000000 ],
    [-0.000343, 0.000000, 0.000023, -0.000006, -0.000028, -0.000046, 0.000000, 0.000001, 1.000000, 0.000000, 0.000000 ],
    [-0.000251, 0.000000, 0.000041, -0.000028, -0.000041, -0.000083, 0.000000, 0.000000, 0.000000, 1.000000, -0.000000 ],
    [-0.000126, 0.000000, 0.000066, -0.000046, -0.000083, -0.000123, 0.000000, 0.000000, 0.000000 ,-0.000000, 1.000000 ]],dtype = np.float32)

S3=np.array([[1.000000, 0.000000, 0.000000, -0.000000, -0.000000, -0.000000, 0.000035, 0.036546, -0.048771, -0.035765, -0.017883 ],
[0.000000, 1.000000, 0.236704, 0.000000, 0.000000, 0.000000, 0.000000, 0.002962, 0.001496, 0.002693, 0.004339 ],
[0.000000, 0.236704 ,1.000000, -0.000000, -0.000000, -0.000000, 0.000001, 0.035569, 0.017236, 0.031024, 0.049984 ],
[-0.000000, 0.000000, -0.000000, 1.000000, 0.000000, 0.000000, -0.000001, -0.006672, 0.005238, -0.006534, -0.010527 ],
[-0.000000, 0.000000, -0.000000, 0.000000, 1.000000, 0.000000, -0.000001, -0.012009 ,-0.006534, -0.002893, -0.018948 ],
[-0.000000, 0.000000, -0.000000, 0.000000, 0.000000, 1.000000, -0.000002, -0.019348 ,-0.010527, -0.018948, -0.021659 ],
[0.000035, 0.000000, 0.000001, -0.000001, -0.000001, -0.000002, 1.000000, 0.241137, 0.000000, 0.000000, 0.000000 ],
[0.036546, 0.002962, 0.035569 ,-0.006672, -0.012009, -0.019348, 0.241137, 1.000000, 0.000000, -0.000000 ,0.000000 ],
[-0.048771, 0.001496, 0.017236, 0.005238, -0.006534, -0.010527, 0.000000, 0.000000, 1.000000, 0.000000, 0.000000 ],
[-0.035765, 0.002693, 0.031024, -0.006534, -0.002893, -0.018948, 0.000000, -0.000000, 0.000000, 1.000000 ,0.000000 ],
[-0.017883, 0.004339, 0.049984, -0.010527, -0.018948, -0.021659, 0.000000, 0.000000, 0.000000, 0.000000, 1.000000] ],dtype = np.float32)


S4=np.array([[1.000000, 0.000000 ,0.000000 ,-0.000000 ,-0.000000 ,-0.000000 ,0.000035 ,0.036546, -0.048771, -0.035765 ,-0.017883 ,0.000455, 0.017913, -0.007321, -0.025868, -0.005857 ],
[0.000000, 1.000000, 0.236704 ,0.000000, 0.000000, 0.000000 ,0.000000 ,0.002962 ,0.001496, 0.002693, 0.004339, 0.000000, 0.000000,0.000000 ,0.000000, 0.000000 ],
[0.000000, 0.236704, 1.000000, -0.000000, -0.000000, -0.000000, 0.000001 ,0.035569, 0.017236, 0.031024, 0.049984, 0.000000 ,0.000001 ,0.000001 ,0.000001, 0.000002 ],
[-0.000000, 0.000000 ,-0.000000 ,1.000000, 0.000000, 0.000000, -0.000001, -0.006672, 0.005238 ,-0.006534, -0.010527, -0.000000, -0.000001, -0.000002 ,-0.000001 ,-0.000003 ],
[-0.000000, 0.000000, -0.000000, 0.000000, 1.000000, 0.000000, -0.000001, -0.012009, -0.006534 ,-0.002893 ,-0.018948, -0.000000, -0.000000 ,-0.000001, -0.000000, -0.000001 ],
[-0.000000, 0.000000, -0.000000, 0.000000, 0.000000, 1.000000, -0.000002, -0.019348, -0.010527, -0.018948, -0.021659, -0.000000 ,-0.000001 ,-0.000003, -0.000001 ,-0.000002 ],
[0.000035, 0.000000, 0.000001 ,-0.000001, -0.000001, -0.000002, 1.000000, 0.241137, 0.000000 ,0.000000, 0.000000, 0.000000, 0.006656, 0.013139, -0.002628, 0.002920 ],
[0.036546, 0.002962, 0.035569 ,-0.006672, -0.012009, -0.019348, 0.241137, 1.000000, 0.000000 ,-0.000000 ,0.000000, 0.020798, 0.213670, 0.134812, -0.026962, 0.029958 ],
[-0.048771, 0.001496, 0.017236, 0.005238, -0.006534, -0.010527, 0.000000, 0.000000 ,1.000000 ,0.000000, 0.000000 ,-0.033960 ,-0.313077, -0.176221, 0.054321, -0.060357 ],
[-0.035765, 0.002693, 0.031024, -0.006534, -0.002893 ,-0.018948, 0.000000, -0.000000 ,0.000000 ,1.000000, 0.000000, 0.006792, 0.062615, 0.054321, 0.084520 ,0.012071 ],
[-0.017883, 0.004339, 0.049984, -0.010527, -0.018948,-0.021659, 0.000000 ,0.000000 ,0.000000 ,0.000000 ,1.000000 ,-0.007547, -0.069573, -0.060357, 0.012071 ,0.081972 ],
[0.000455, 0.000000, 0.000000 ,-0.000000 ,-0.000000, -0.000000 ,0.000000, 0.020798, -0.033960 ,0.006792 ,-0.007547, 1.000000, 0.248362 ,0.000000, 0.000000 ,-0.000000 ],
[0.017913, 0.000000, 0.000001 ,-0.000001, -0.000000 ,-0.000001, 0.006656, 0.213670, -0.313077 ,0.062615, -0.069573, 0.248362, 1.000000, -0.000000, 0.000000, 0.000000 ],
[-0.007321, 0.000000, 0.000001, -0.000002, -0.000001, -0.000003, 0.013139, 0.134812, -0.176221 ,0.054321, -0.060357, 0.000000 ,-0.000000, 1.000000, 0.000000 ,0.000000 ],
[-0.025868, 0.000000, 0.000001, -0.000001 ,-0.000000, -0.000001, -0.002628, -0.026962, 0.054321, 0.084520, 0.012071, 0.000000, 0.000000 ,0.000000, 1.000000 ,0.000000 ],
[-0.005857, 0.000000, 0.000002, -0.000003, -0.000001, -0.000002, 0.002920, 0.029958 ,-0.060357, 0.012071, 0.081972 ,-0.000000, 0.000000, 0.000000, 0.000000 ,1.000000 ]],dtype = np.float32)

0.9999999908897999, 8.485806523168149e-16, 4.8976976063215463e-11, -8.326316139686609e-11, -8.326316139686609e-11, -8.326316139686609e-11, 3.509301193890227e-05, 0.036545946955955276, -0.04877052344238632, -0.035765050524416635, -0.017882525262208317, 0.0004548125709682273, 0.017912569100110017, -0.007321037983318079, -0.025867667541057206, -0.005856830386654461, 
8.485806523168148e-16, 1.0000000165470366, 0.2367039416499711, 6.311319040196644e-16, 6.311319040196644e-16, 6.311319040196644e-16, 2.848156074361428e-17, 0.002961928542266554, 0.00149618996686715, 0.0026931419403608686, 0.004338950903914733, 2.4663430092691182e-96, 1.004023778796735e-10, 3.349876927811768e-10, 1.3914873392448886e-10, 3.504486632172311e-10, 
4.8976976063215463e-11, 0.23670394164997102, 1.0000000268753377, 0.0, 0.0, 0.0, 6.341016687185668e-07, 0.035568852555547155, 0.01723582859821388, 0.03102449147678499, 0.049983902934820246, 7.69933962516514e-16, 6.806793652262344e-07, 1.476378479460863e-06, 6.132649068529737e-07, 1.5445190246667494e-06, 
-8.32631613968661e-11, 6.311319040196645e-16, 0.0, 1.0000000195212955, 0.0, 0.0, -5.945298743453169e-07, -0.006671809487866506, 0.005238066826002802, -0.0065337769926089705, -0.01052664071031445, -3.1297066884125207e-15, -1.1323005421074944e-06, -2.253005695180045e-06, -1.0217887940382864e-06, -2.573393999800129e-06, 
-8.32631613968661e-11, 6.311319040196645e-16, 0.0, 0.0, 1.0000000195212955, 0.0, -1.07015377382157e-06, -0.012009257078159637, -0.0065337769926089384, -0.0028928556536883046, -0.018947953278565917, -1.3000320090328938e-15, -4.703402251831133e-07, -1.021788794038287e-06, -2.1757912882229573e-07, -1.0689482768400543e-06, 
-8.32631613968661e-11, 6.311319040196645e-16, 0.0, 0.0, 0.0, 1.0000000195212957, -1.7241366356014183e-06, -0.0193482475148128, -0.010526640710314424, -0.018947953278565962, -0.02165931512690404, -3.2741546894161756e-15, -1.1845605671278402e-06, -2.5733939998001282e-06, -1.0689482768400528e-06, -2.4853098141665262e-06, 
3.509301193890227e-05, 2.848156074361427e-17, 6.341016687185668e-07, -5.945298743453169e-07, -1.07015377382157e-06, -1.7241366356014183e-06, 0.9999999954918732, 0.24113665111145946, -1.8425332663117223e-17, 3.0264497297045513e-18, -4.9087538415212435e-17, 8.747817667541317e-08, 0.006655724102905275, 0.013138799282950987, -0.002627759856590195, 0.002919733173989109, 
0.036545946955955276, 0.0029619285422665537, 0.03556885255554716, -0.006671809487866506, -0.012009257078159639, -0.0193482475148128, 0.24113665111145943, 1.0000000039071328, 2.807405140417889e-16, 2.4837883351663347e-16, 1.3523215450601729e-16, 0.02079805841716897, 0.2136696961706175, 0.13481244326842878, -0.0269624886536857, 0.029958320726317485, 
-0.048770523442386325, 0.0014961899668671497, 0.017235828598213883, 0.005238066826002801, -0.0065337769926089384, -0.010526640710314422, -1.8425332663117223e-17, 2.807405140417889e-16, 1.0000000636562136, 1.0120582302909616e-31, 5.060291151454808e-32, -0.03396011016885166, -0.3130771689207939, -0.17622117645363108, 0.05432109756638419, -0.06035677507376024, 
-0.035765050524416635, 0.002693141940360868, 0.031024491476784995, -0.00653377699260897, -0.0028928556536883046, -0.018947953278565962, 3.026449729704553e-18, 2.4837883351663347e-16, 1.0120582302909616e-31, 1.0000000636562136, 1.1405680327821118e-31, 0.006792022033770325, 0.06261543378415876, 0.05432109756638423, 0.08452009186501325, 0.012071355014752051, 
-0.017882525262208317, 0.004338950903914733, 0.049983902934820246, -0.010526640710314448, -0.01894795327856592, -0.021659315126904038, -4.9087538415212423e-17, 1.3523215450601729e-16, 5.060291151454808e-32, 1.1405680327821118e-31, 1.0000000636562139, -0.007546691148633704, -0.06957270420462086, -0.060356775073760256, 0.012071355014752039, 0.08197169469523226, 
0.00045481257096822726, 2.4663430092691182e-96, 7.69933962516514e-16, -3.1297066884125207e-15, -1.3000320090328938e-15, -3.2741546894161756e-15, 8.747817667541315e-08, 0.020798058417168967, -0.03396011016885166, 0.006792022033770324, -0.007546691148633703, 0.999999999881269, 0.2483623901066388, 0.0, -6.201231949497154e-17, 0.0, 
0.017912569100110014, 1.0040237787967351e-10, 6.806793652262344e-07, -1.1323005421074946e-06, -4.7034022518311337e-07, -1.1845605671278404e-06, 0.006655724102905275, 0.2136696961706175, -0.31307716892079396, 0.06261543378415879, -0.06957270420462086, 0.24836239010663885, 0.9999999984802169, -2.470212683853543e-16, -6.207520456016776e-16, 0.0, 
-0.0073210379833180805, 3.349876927811768e-10, 1.476378479460863e-06, -2.253005695180045e-06, -1.021788794038287e-06, -2.5733939998001282e-06, 0.013138799282950987, 0.13481244326842878, -0.1762211764536311, 0.05432109756638423, -0.060356775073760256, 0.0, -2.4702126838535426e-16, 0.9999999729969503, 2.909007509302903e-31, 0.0, 
-0.02586766754105721, 1.3914873392448884e-10, 6.132649068529737e-07, -1.0217887940382864e-06, -2.1757912882229573e-07, -1.0689482768400528e-06, -0.002627759856590195, -0.0269624886536857, 0.05432109756638418, 0.08452009186501326, 0.012071355014752039, -6.201231949497157e-17, -6.207520456016774e-16, 2.909007509302903e-31, 0.9999999729969503, 0.0, 
-0.005856830386654464, 3.504486632172311e-10, 1.5445190246667494e-06, -2.573393999800129e-06, -1.0689482768400543e-06, -2.4853098141665262e-06, 0.002919733173989109, 0.029958320726317485, -0.06035677507376024, 0.012071355014752051, 0.08197169469523227, 0.0, 0.0, 0.0, 0.0, 0.9999999729969503

write(S1,1)
write(S2,2)
write(S3,3)
write(S4,4)

