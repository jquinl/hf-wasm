from scipy.linalg import lu,inv
import numpy as np

f = np.vectorize(lambda x: x if abs(x)>1e-5 else 00.0)
def write(arr, n):
    p,l,u = lu(arr)
    lus = l+u - np.eye(arr.shape[0])
    np.savetxt("{}lu.csv".format(n), f(lus), delimiter=",",fmt='%.6f')
    np.savetxt("{}inv.csv".format(n), f(inv(arr)), delimiter=",",fmt='%.6f')

S2 =np.array([[ 1.000000, 0.000000, 0.000000 ,-0.000000, -0.000000, -0.000000, 0.000002, 0.000255 ,-0.000343 ,-0.000251, -0.000126 ],
    [0.000000, 1.000000, 0.236704, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 ,0.000000, 0.000000, 0.000000 ],
    [0.000000, 0.236704, 1.000000, -0.000000, -0.000000, -0.000000, 0.000000, 0.000033 ,0.000023, 0.000041, 0.000066 ],
    [-0.000000, 0.000000, -0.000000, 1.000000, 0.000000, 0.000000, -0.000000, -0.000023 ,-0.000006 ,-0.000028, -0.000046 ],
    [-0.000000, 0.000000, -0.000000, 0.000000, 1.000000, 0.000000, -0.000000, -0.000041, -0.000028 ,-0.000041, -0.000083 ],
    [-0.000000, 0.000000, -0.000000, 0.000000, 0.000000, 1.000000, -0.000000, -0.000066, -0.000046 ,-0.000083, -0.000123 ],
    [0.000002, 0.000000, 0.000000, -0.000000, -0.000000, -0.000000, 1.000000, 0.236704, 0.000000, 0.000000, 0.000000 ],
    [0.000255, 0.000000, 0.000033, -0.000023, -0.000041, -0.000066, 0.236704, 1.000000, 0.000001, 0.000000, 0.000000 ],
    [-0.000343, 0.000000, 0.000023, -0.000006, -0.000028, -0.000046, 0.000000, 0.000001, 1.000000, 0.000000, 0.000000 ],
    [-0.000251, 0.000000, 0.000041, -0.000028, -0.000041, -0.000083, 0.000000, 0.000000, 0.000000, 1.000000, -0.000000 ],
    [-0.000126, 0.000000, 0.000066, -0.000046, -0.000083, -0.000123, 0.000000, 0.000000, 0.000000 ,-0.000000, 1.000000 ]],dtype = np.float32)

S3=np.array([[1.000000, 0.000000, 0.000000, -0.000000, -0.000000, -0.000000, 0.000035, 0.036546, -0.048771, -0.035765, -0.017883 ],
[0.000000, 1.000000, 0.236704, 0.000000, 0.000000, 0.000000, 0.000000, 0.002962, 0.001496, 0.002693, 0.004339 ],
[0.000000, 0.236704 ,1.000000, -0.000000, -0.000000, -0.000000, 0.000001, 0.035569, 0.017236, 0.031024, 0.049984 ],
[-0.000000, 0.000000, -0.000000, 1.000000, 0.000000, 0.000000, -0.000001, -0.006672, 0.005238, -0.006534, -0.010527 ],
[-0.000000, 0.000000, -0.000000, 0.000000, 1.000000, 0.000000, -0.000001, -0.012009 ,-0.006534, -0.002893, -0.018948 ],
[-0.000000, 0.000000, -0.000000, 0.000000, 0.000000, 1.000000, -0.000002, -0.019348 ,-0.010527, -0.018948, -0.021659 ],
[0.000035, 0.000000, 0.000001, -0.000001, -0.000001, -0.000002, 1.000000, 0.241137, 0.000000, 0.000000, 0.000000 ],
[0.036546, 0.002962, 0.035569 ,-0.006672, -0.012009, -0.019348, 0.241137, 1.000000, 0.000000, -0.000000 ,0.000000 ],
[-0.048771, 0.001496, 0.017236, 0.005238, -0.006534, -0.010527, 0.000000, 0.000000, 1.000000, 0.000000, 0.000000 ],
[-0.035765, 0.002693, 0.031024, -0.006534, -0.002893, -0.018948, 0.000000, -0.000000, 0.000000, 1.000000 ,0.000000 ],
[-0.017883, 0.004339, 0.049984, -0.010527, -0.018948, -0.021659, 0.000000, 0.000000, 0.000000, 0.000000, 1.000000] ],dtype = np.float32)


S4=np.array([[1.000000, 0.000000 ,0.000000 ,-0.000000 ,-0.000000 ,-0.000000 ,0.000035 ,0.036546, -0.048771, -0.035765 ,-0.017883 ,0.000455, 0.017913, -0.007321, -0.025868, -0.005857 ],
[0.000000, 1.000000, 0.236704 ,0.000000, 0.000000, 0.000000 ,0.000000 ,0.002962 ,0.001496, 0.002693, 0.004339, 0.000000, 0.000000,0.000000 ,0.000000, 0.000000 ],
[0.000000, 0.236704, 1.000000, -0.000000, -0.000000, -0.000000, 0.000001 ,0.035569, 0.017236, 0.031024, 0.049984, 0.000000 ,0.000001 ,0.000001 ,0.000001, 0.000002 ],
[-0.000000, 0.000000 ,-0.000000 ,1.000000, 0.000000, 0.000000, -0.000001, -0.006672, 0.005238 ,-0.006534, -0.010527, -0.000000, -0.000001, -0.000002 ,-0.000001 ,-0.000003 ],
[-0.000000, 0.000000, -0.000000, 0.000000, 1.000000, 0.000000, -0.000001, -0.012009, -0.006534 ,-0.002893 ,-0.018948, -0.000000, -0.000000 ,-0.000001, -0.000000, -0.000001 ],
[-0.000000, 0.000000, -0.000000, 0.000000, 0.000000, 1.000000, -0.000002, -0.019348, -0.010527, -0.018948, -0.021659, -0.000000 ,-0.000001 ,-0.000003, -0.000001 ,-0.000002 ],
[0.000035, 0.000000, 0.000001 ,-0.000001, -0.000001, -0.000002, 1.000000, 0.241137, 0.000000 ,0.000000, 0.000000, 0.000000, 0.006656, 0.013139, -0.002628, 0.002920 ],
[0.036546, 0.002962, 0.035569 ,-0.006672, -0.012009, -0.019348, 0.241137, 1.000000, 0.000000 ,-0.000000 ,0.000000, 0.020798, 0.213670, 0.134812, -0.026962, 0.029958 ],
[-0.048771, 0.001496, 0.017236, 0.005238, -0.006534, -0.010527, 0.000000, 0.000000 ,1.000000 ,0.000000, 0.000000 ,-0.033960 ,-0.313077, -0.176221, 0.054321, -0.060357 ],
[-0.035765, 0.002693, 0.031024, -0.006534, -0.002893 ,-0.018948, 0.000000, -0.000000 ,0.000000 ,1.000000, 0.000000, 0.006792, 0.062615, 0.054321, 0.084520 ,0.012071 ],
[-0.017883, 0.004339, 0.049984, -0.010527, -0.018948,-0.021659, 0.000000 ,0.000000 ,0.000000 ,0.000000 ,1.000000 ,-0.007547, -0.069573, -0.060357, 0.012071 ,0.081972 ],
[0.000455, 0.000000, 0.000000 ,-0.000000 ,-0.000000, -0.000000 ,0.000000, 0.020798, -0.033960 ,0.006792 ,-0.007547, 1.000000, 0.248362 ,0.000000, 0.000000 ,-0.000000 ],
[0.017913, 0.000000, 0.000001 ,-0.000001, -0.000000 ,-0.000001, 0.006656, 0.213670, -0.313077 ,0.062615, -0.069573, 0.248362, 1.000000, -0.000000, 0.000000, 0.000000 ],
[-0.007321, 0.000000, 0.000001, -0.000002, -0.000001, -0.000003, 0.013139, 0.134812, -0.176221 ,0.054321, -0.060357, 0.000000 ,-0.000000, 1.000000, 0.000000 ,0.000000 ],
[-0.025868, 0.000000, 0.000001, -0.000001 ,-0.000000, -0.000001, -0.002628, -0.026962, 0.054321, 0.084520, 0.012071, 0.000000, 0.000000 ,0.000000, 1.000000 ,0.000000 ],
[-0.005857, 0.000000, 0.000002, -0.000003, -0.000001, -0.000002, 0.002920, 0.029958 ,-0.060357, 0.012071, 0.081972 ,-0.000000, 0.000000, 0.000000, 0.000000 ,1.000000 ]],dtype = np.float32)

write(S2,2)
write(S3,3)
write(S4,4)

